(this["webpackJsonpsimple-rule-example"]=this["webpackJsonpsimple-rule-example"]||[]).push([[0],{12:function(e,r,t){"use strict";t.r(r);t(5);var n=t(0),o=t.n(n),a=t(2),c=t.n(a),i=t(1),u=t(3),l=Object(n.createContext)(),s=function(e){var r=e.rulesSchema,t=e.userRolesSchema,a=e.currentUser,c=e.children,i=function(e,r,t){var o=Object(n.useCallback)((function(e){var r={};return Object.entries(e).forEach((function(e){var t=e[0],n=e[1];r[t]=function(e){return n(e)}})),r}),[t])(r),a=Object(n.useCallback)((function(e){return function(r){return e({record:r,currentUser:t,roles:o})}}),[t,o]);return Object(n.useCallback)((function(e){var r={};return Object.entries(e).forEach((function(e){var t=e[0],n=e[1],o={};Object.entries(n).forEach((function(e){var r=e[0],t=e[1];if(!(t instanceof Function))throw new Error("Invalid rule format");o[r]=a(t)})),r[t]=o})),r}),[t])(e)}(r,t,a);return o.a.createElement(l.Provider,{value:i},c)},d=function(e){var r=Object(n.useContext)(l);if(!e)throw new Error("Empty entity in simple-rules useRules hook");return r[e]},f=function(e){var r=e.rule,t=e.record,n=e.entity,o=e.children;return d(n)[r](t)?o:null},m=[{id:1,content:"Post visible for user with id = 1",owner_id:1},{id:2,content:"Post visible for user with id = 2",owner_id:2},{id:3,content:"Post visible for all users, unavailable for destroy",owner_id:null}],v=function(){var e=d("post"),r=function(e){if(!e)throw new Error("Empty entity in simple-rules usePermissions hook");return Object(n.useCallback)((function(r){var t=r.rule,n=r.record,a=r.children;return o.a.createElement(f,{rule:t,record:n,children:a,entity:e})}),[e])}("post");return m.map((function(t){return o.a.createElement("div",{key:t.id},e.show(t)&&"".concat(t.id,". ").concat(t.content),o.a.createElement(r,{rule:"destroy",record:t},"(Available for destroy)"))}))},b={post:{show:function(e){var r=e.currentUser,t=e.record;e.roles;return!t.owner_id||t.owner_id===r.id},destroy:function(e){var r=e.currentUser,t=e.record;return e.roles.admin(r)&&t.owner_id===r.id}}},p={admin:function(e){return"admin"===e.role}},h=function(){var e=Object(n.useState)({id:1,role:"admin"}),r=Object(u.a)(e,2),t=r[0],a=r[1];return o.a.createElement(s,{rulesSchema:b,userRolesSchema:p,currentUser:t},o.a.createElement("p",null,"User id:",o.a.createElement("select",{value:t.id,onChange:function(e){var r=e.target.value;a((function(e){return Object(i.a)(Object(i.a)({},e),{},{id:parseInt(r)})}))}},o.a.createElement("option",{value:1},"1"),o.a.createElement("option",{value:2},"2"),o.a.createElement("option",{value:3},"3"))),o.a.createElement("p",null,"User role:",o.a.createElement("select",{value:t.role,onChange:function(e){var r=e.target.value;a((function(e){return Object(i.a)(Object(i.a)({},e),{},{role:r})}))}},o.a.createElement("option",{value:"admin"},"Admin"),o.a.createElement("option",{value:"client"},"Client"))),o.a.createElement(v,null))};c.a.render(o.a.createElement(h,null),document.getElementById("root"))},4:function(e,r,t){e.exports=t(12)},5:function(e,r,t){}},[[4,1,2]]]);
//# sourceMappingURL=main.2a0d65f3.chunk.js.map